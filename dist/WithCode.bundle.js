(()=>{"use strict";const e=new class{constructor(e,t,a){if(this.apiKey=e,this.chatID=t,this.apiURL=a,!this.chatID)return void flash("請設定 chatID。");if(!this.apiKey)return void flash("請設定 apiKey。");const i=(new Date).getHours();this.isNightTime=i>=22||i<7}sendMessage(e){if(!e.text)return void flash("不能發送空白訊息。");if(e.text.length>4096)return void flash("訊息超過 4096 字元。");const t={chat_id:this.chatID,text:e.text,parse_mode:e.parse_mode||"HTML",disable_notification:this.isNightTime},a={method:"POST",headers:new Headers({"Content-Type":"application/x-www-form-urlencoded"}),body:new URLSearchParams({...t,...e}),redirect:"follow"};fetch(`https://${this.apiURL}/bot${this.apiKey}/sendMessage`,a).then((e=>e.json())).then(e.resultHandler||(e=>{e.ok?flash("📩 信息已發送。"):flash("📩 信息發送異常："+e.description)})).catch(e.errorHandler||(e=>flash(`📩 信息發送異常：${e}`))).then(e.exitHandler||(()=>{"undefined"!=typeof exit&&exit()}))}}(global("apiKey"),global("chatID"),"api.telegram.org"),t=e.isNightTime?"🔕":"",a=global("SMSRB"),i=global("MMSRS");let s=" #"+global("SMSRN")+")";s.match(/\s?\(?#?\+?\d+\)?/g)[0].length>0&&(s="");const l=global("SMSRF").replace("+852","");let r="%SMSRB"===a?"%MMSRS"===i?"無法獲取短訊內容":i:a;r=r.replace(/(\d+-\d+-\d+)|(\d{3,}-\d{3,})|\d{5,}/gm,(function(e){return"<code>"+e+"</code>"}));const o="✉ <b>"+l+s+"</b>\n"+function(e,t){let a=~~(e%12*2+t/30+.5);return a+=a<2?24:0,String.fromCharCode(55357,56655+(a+a%2*23)/2)}(global("SMSRT").split(".")[0],global("SMSRT").split(".")[1])+" "+global("SMSRD")+" "+global("SMSRT").replace(".",":")+" "+t+"\n\n"+r;e.sendMessage({text:o,disable_web_page_preview:!0,resultHandler:e=>{e.ok?flash("📩 信息已轉發。"):flash("📩 信息轉發錯誤："+e.description)},errorHandler:e=>flash("📩 信息轉發異常："+e),exitHandler:exit})})();